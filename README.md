# health-observation

学校や会社などの組織で簡単に健康監視を行うためのアドオンです。

## リンク

- [Privacy policy（プライバシーポリシー）](https://teramotodaiki.github.io/health-observation/PRIVACY_POLICY)
- [Terms of use（利用規約）](https://teramotodaiki.github.io/health-observation/TERMS_OF_USE)


## スクリーンショット

> ダミーデータを用いています

### 入力フォーム
[![Image from Gyazo](https://i.gyazo.com/78ca77ee2cb2816dfbbc3ec9427fc1bd.png)](https://gyazo.com/78ca77ee2cb2816dfbbc3ec9427fc1bd)

### 日付ごとに並べたシート（自動生成）
[![Image from Gyazo](https://i.gyazo.com/6635b05c61f2eeeb4fcbf6d4353abe6b.png)](https://gyazo.com/6635b05c61f2eeeb4fcbf6d4353abe6b)

### 経過観察開始からの経過日数ごとに並べたシート（自動生成）
[![Image from Gyazo](https://i.gyazo.com/195055d32c834f52bf91ec4ead0ae9e1.png)](https://gyazo.com/195055d32c834f52bf91ec4ead0ae9e1)


## 機能

- Google フォームで送信された内容をもとに、「日付ごと」「経過観察開始からの経過日数ごと」に並べたシートを自動生成します。
- 経過観察期間は **１４日間** とし、それ以上の期間が経過した個人はシートから除外されます。
- 各シートの「備考」欄に書かれた文字は、もう一方のシートにも同期されます。
- 任意の個人識別子を用いることができます。（例：社員番号、メールアドレス、ハンドルネーム）
  - 詳しくは [フォームの作り方](#フォームの作り方) を参照してください
- １日に複数の回答が送信された場合、【重複あり】と表示されます。スプレッドシート上の重複データを直接削除することも可能です。

## 準備①　フォームを作成する

> 現在アドオンの公開審査中につき、Google 公式ストアからのインストールは出来ません。２０２０年３月以降に導入予定の方は、アドオンの公開をお待ちください
> なお、 **本アドオンのソースコードは全て一般公開されています** 

1. [Google フォーム](https://www.google.com/intl/ja_jp/forms/about/) で調査用のフォームを作成します。詳しくは [フォームの作り方](#フォームの作り方) を参照してください
2. *スプレッドシートの作成* （または *回答をスプレッドシートに表示* ）をクリックして、新しいスプレッドシートを作ります。名前はなんでも構いません。
  [![Image from Gyazo](https://i.gyazo.com/fe67df9733dd396f29d5ba12eae0df22.png)](https://gyazo.com/fe67df9733dd396f29d5ba12eae0df22)
3. これで

## 準備②　アドオンを適用する

1. [こちらのリンクをクリック](https://script.google.com/d/1Can7MRQ877AVAzD6W8x9-eS_yLSpd0FtLN0nBY6Y8fs5ngqly5RKtaXc/edit?usp=sharing) して、ページを開きます
1. あなたの Google アカウントでログインします（このあとファイルをコピーするために必要です。あなたの個人情報は読み取りません）
1. *ファイル* → *コピーを作成* をクリックします  
  [![Image from Gyazo](https://i.gyazo.com/3820661427fbb7b98e6be7350c761506.png)](https://gyazo.com/3820661427fbb7b98e6be7350c761506)
1. *実行* → *アドオンとしてテスト* をクリックします
  [![Image from Gyazo](https://i.gyazo.com/badffb4a07db12821aa4524ecfd96eda.png)](https://gyazo.com/badffb4a07db12821aa4524ecfd96eda)
1. **インストール設定** を *インストール済み、有効* に変更します  
  [![Image from Gyazo](https://i.gyazo.com/4da32ed4058d1df2102e6db98715c720.png)](https://gyazo.com/4da32ed4058d1df2102e6db98715c720)
1. *ドキュメントを選択* → *スプレッドシート* の順にクリックし、一覧から先ほど作成したスプレッドシートを選択します
1. *保存* をクリックします
1. **保存済みのテストを実行する** に新しい行が追加されているので、丸いチェックをオンにして *テスト* をクリックします  
  [![Image from Gyazo](https://i.gyazo.com/a92c9235bb7a13ebf15cc0581d921a92.png)](https://gyazo.com/a92c9235bb7a13ebf15cc0581d921a92)
1. インストールしてから数秒後に、「経過観察開始からの経過日数ごと」「日付ごと」の２つのシートが生成されます。これでセットアップは完了です 🎉 お疲れ様でした！

## 準備ができたら

学生や社員など、対象者にフォームを送信します。Google フォームの *送信* をクリックすると、メールやリンクなどの方法で配布できます。詳しくは [フォームの配布](#フォームの配布) を参照してください

## フォームの作り方

タイトル、説明文、質問項目など、フォームの内容は自由に決められます。

ただし、 **最初の質問は個人識別子を問う質問にすること。** 個人識別子とは、たとえば「社員番号」「メールアドレス」などです。Google フォームの *メールアドレスを収集する* オプションを用いても構いません。

２問目以降は自由に質問を追加できますが、スプレッドシートの見栄えを考えると、あまり質問を多くすることは推奨されません。現在、特定の質問を表示しないようにすることはできません。

また、質問文の一文字目（e.g. 体温であれば `体` ）がシートに反映されるので、一文字目をユニークにするといいかも知れません。

例： `体温` に `36.7` と回答した場合、フォームには `体:36.7` と表示されます。

## フォームの配布

Google フォームの編集画面の右上にある *送信* ボタンを押すと、配布方法のメニューが表示されます
[![Image from Gyazo](https://i.gyazo.com/2fedef0720f2b4c86f2650fbb1c08d0c.png)](https://gyazo.com/2fedef0720f2b4c86f2650fbb1c08d0c)

### 個人識別子を事前入力する

社員番号やメールアドレスなどの個人識別子は、人によっては忘れていたり、打ち間違えてしまう恐れがあります。Google フォームの機能を使うと、フォームの項目をあらかじめ埋めた状態で配布することができます

事前入力を行うには、Google フォームの編集画面でメニューアイコンをクリックし、 *事前入力したリンクを取得* をクリックします
[![Image from Gyazo](https://i.gyazo.com/258269274d8abd6aaafe5fa7c3f719f3.png)](https://gyazo.com/258269274d8abd6aaafe5fa7c3f719f3)

実際のフォームと全く同じ画面が出てくるので、事前入力したい項目を埋めて、下にある *リンクを取得* ボタンをクリックします

クリップボードにリンクがコピーされるので、対象者にメール等の手段で送付します。このリンクは何度も使い回すことが出来ます。



## その他

### 観察期間開始のタイミングはどのように決定されますか？

最初に回答があった日を観察期間開始とみなします。

### 発熱を赤くするなど、特定のセルだけ書式を変更できますか？

スプレッドシートのカスタム書式設定をご自身で定義できます。現在、このアドオンでは標準サポートしていません。

